<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lista Bivacchi con Hello Kitty</title>
    <style>
        /* Stile del cursore personalizzato */
        html {
            cursor: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><path fill="%23FF69B4" d="M16 2C8.2 2 2 8.2 2 16s6.2 14 14 14 14-6.2 14-14S23.8 2 16 2zm0 2c6.6 0 12 5.4 12 12s-5.4 12-12 12S4 22.6 4 16 9.4 4 16 4z"/><circle fill="%23FF69B4" cx="11" cy="11" r="2"/><circle fill="%23FF69B4" cx="21" cy="11" r="2"/><path fill="%23FF69B4" d="M16 20c-2.8 0-5-2.2-5-5h2c0 1.7 1.3 3 3 3s3-1.3 3-3h2c0 2.8-2.2 5-5 5z"/><path fill="%23FF69B4" d="M16 24c-1.1 0-2-.9-2-2h4c0 1.1-.9 2-2 2z"/></svg>') 16 16, auto;
        }
        
        button, input, select, textarea, .delete-btn {
            cursor: default;
        }

        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            color: #333;
            background-color: #fff9fb;
        }
        h1 {
            color: #d23669;
            text-align: center;
            margin-bottom: 30px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        th, td {
            border: 1px solid #ffb6c1;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #ffebf1;
            color: #d23669;
        }
        tr:nth-child(even) {
            background-color: #fff0f5;
        }
        tr:hover {
            background-color: #ffe6ee;
        }
        button {
            background-color: #ff69b4;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px 0;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #ff1493;
        }
        .edit-form {
            display: none;
            margin: 20px 0;
            padding: 20px;
            background-color: #fff0f5;
            border: 1px solid #ffb6c1;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .edit-form h3 {
            color: #d23669;
            margin-top: 0;
        }
        .edit-form input, .edit-form select {
            margin: 8px 0;
            padding: 10px;
            width: 100%;
            border: 1px solid #ffb6c1;
            border-radius: 5px;
        }
        .annotations-box {
            margin: 20px 0;
            padding: 20px;
            background-color: #f0f7ff;
            border: 1px solid #b3d1ff;
            border-radius: 5px;
        }
        .annotations-box h3 {
            margin-top: 0;
            color: #0066cc;
        }
        #annotationsText {
            width: 100%;
            min-height: 100px;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #b3d1ff;
            border-radius: 5px;
            font-family: Arial, sans-serif;
        }
        #saveAnnotations {
            background-color: #0066cc;
        }
        #saveAnnotations:hover {
            background-color: #0052a3;
        }
        .delete-btn {
            width: 24px;
            height: 24px;
            cursor: pointer;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23ff0000"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>') no-repeat;
            border: none;
            transition: transform 0.2s;
        }
        .delete-btn:hover {
            transform: scale(1.1);
        }
        .loading {
            text-align: center;
            padding: 20px;
            font-style: italic;
            color: #ff69b4;
        }
        .info-message {
            background-color: #e6f7ff;
            border: 1px solid #b3e0ff;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
            color: #0066cc;
        }
    </style>
</head>
<body>
    <h1>üå∏ Lista Bivacchi Hello Kitty üå∏</h1>
    
    <div class="info-message">
        ‚ÑπÔ∏è I dati vengono caricati dal Gist pubblico. Per modificare i dati, contatta l'amministratore.
    </div>
    
    <!-- Box annotazioni -->
    <div class="annotations-box">
        <h3>Annotazioni</h3>
        <textarea id="annotationsText" placeholder="Scrivi qui note generali..." readonly></textarea>
    </div>
    
    <!-- Tabella bivacchi -->
    <table id="bivacchiTable">
        <thead>
            <tr>
                <th>#</th>
                <th>Nome</th>
                <th>Provincia</th>
                <th>Altitudine (m)</th>
                <th>Posti letto</th>
                <th>Camino</th>
                <th>Stufa</th>
                <th>Qualit√†</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            <tr>
                <td colspan="8" class="loading">Caricamento dati in corso...</td>
            </tr>
        </tbody>
    </table>

    <script>
        // Configurazione Gist
        const GIST_ID = "43c3055909259ddbc7e4c61525ac998a";
        const GIST_URL = `https://gist.githubusercontent.com/laitmen/${GIST_ID}/raw`;
        
        // Elementi DOM
        const tableBody = document.getElementById('tableBody');
        const annotationsText = document.getElementById('annotationsText');
        
        // Carica i dati iniziali
        async function loadData() {
            try {
                const response = await fetch(GIST_URL);
                if (!response.ok) throw new Error('Errore nel caricamento dei dati');
                
                const data = await response.json();
                renderTable(data.bivacchi || []);
                annotationsText.value = data.annotazioni || 'Nessuna annotazione presente';
            } catch (error) {
                console.error("Errore:", error);
                renderTable([
                    {nome:"Bivacco X", provincia:"Belluno", altitudine:1500, postiLetto:4, camino:"Si", stufa:"Si", qualita:8},
                    {nome:"Bivacco Y", provincia:"Trento", altitudine:2100, postiLetto:6, camino:"No", stufa:"Si", qualita:6}
                ]);
                annotationsText.value = "Impossibile caricare le annotazioni dal server";
            }
        }
        
        // Renderizza la tabella
        function renderTable(bivacchi) {
            tableBody.innerHTML = '';
            
            if (bivacchi.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="8">Nessun bivacco presente</td></tr>';
                return;
            }
            
            bivacchi.forEach((bivacco, index) => {
                const row = document.createElement('tr');
                
                // Formatta i campi vuoti
                const formatValue = (value) => value === undefined || value === '' ? '-' : value;
                
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${formatValue(bivacco.nome)}</td>
                    <td>${formatValue(bivacco.provincia)}</td>
                    <td>${formatValue(bivacco.altitudine)}</td>
                    <td>${formatValue(bivacco.postiLetto)}</td>
                    <td>${formatValue(bivacco.camino)}</td>
                    <td>${formatValue(bivacco.stufa)}</td>
                    <td>${formatValue(bivacco.qualita)}</td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        // Inizializza la pagina
        loadData();
        
        // Aggiorna i dati ogni 5 minuti
        setInterval(loadData, 300000);
    </script>
</body>
</html>
